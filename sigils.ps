/sigil_parts <<
    % current fits between y=0.25, 0.5
    % set fits between y=-0.5, -0.25
    % state components fit between -0.5, 0.25
    /current {
        0 0.375 ndot
        -0.5 0.5 goto 0.5 0.5 goto 0 0.25 goto closepath nstroke
    }
    /set {
        -0.25 -0.25 goto
        0.25 -0.25 goto
        0 -0.5 goto
        closepath nstroke
        0 -0.25 goto 0 -0.5 goto 
        -0.5 -0.5 goto 
        nstroke
    }
    /color {
        0 -0.125 0.375 30 180 sparc nstroke
        0 -0.125 0.375 180 -30 sparc nstroke
    }
    /cmykcolor {
        sigil_parts /color get exec
        gsave
            0 -0.125 translate
            4 {
                % 0 0.375 goto
                0.375 dup dup -90 -180 arcn
            } circrepeat closepath nstroke
        grestore
    }
    /gray {
        sigil_parts /color get exec
        gsave
            0 -0.125 translate
            0 0 goto 0.375 -30 polar goto nstroke
        grestore
    }
    /hsbcolor {
        sigil_parts /color get exec
        gsave
            0 -0.125 translate
            0 0 0.125 spcircle nstroke
            -0.375 0 goto 0 0 goto 0 0.375 goto nstroke
        grestore
    }
    /rand {
        gsave
            0 -0.125 translate
            0.375 softscale
            6 {
                0 1 goto
            } circrepeat closepath nstroke
            3 {
                0 0 goto 0 -1 goto nstroke
            } circrepeat
        grestore
    }
    /rgbcolor {
        sigil_parts /color get exec
        gsave
            0 -0.125 translate
            3 {
                0 0.375 goto
            } circrepeat closepath nstroke
        grestore
    }
    /line {
        0 0.25 goto 0 -0.5 goto 0.5 -0.5 goto nstroke
    }
    /linecap {
        sigil_parts /line get exec
        0 -0.125 0.25 60 180 sparc
        0 -0.125 0.25 -180 -60 sparc
        nstroke
    }
    /linejoin {
        sigil_parts /line get exec
        0 -0.125 0.25 -150 0 sparc
        0.25 0.125 goto
        -0.25 0.125 goto
        nstroke
    }
    /linewidth {
        sigil_parts /line get exec
        -0.5 0 goto -0.25 -0.25 goto 0 0 -0.125 pop goto 0.25 -0.25 goto 0.5 0 goto nstroke
    }
    /miterlimit {
        -0.5 -0.5 goto
        -0.25 0.25 goto
        0 -0.5 goto
        0.25 1.5 div 0.125 goto
        0.25 0.25 3 div add 0.125 goto
        0.5 -0.5 goto
        nstroke
        0 0.25 goto
        -0.125 -0.25 goto
        0.125 -0.25 goto
        nstroke
    }
    /point {
        -0.5 -0.5 goto
        -0.5 0.25 goto
        0.25 0 0.25 90 -90 sparcn
        -0.5 -0.25 goto
        nstroke
        0 0 ndot
    }
    /matrix {
        -0.5 -0.5 0.5 0.25 box nstroke
        -0.5 -0.125 goto 0.5 -0.125 goto nstroke
        0 -0.5 goto 0 0.25 goto nstroke
    }
    /cv {
        gsave
            1.5 recip softscale
            0 0.25 translate
            0 0.25 0.25 -30 90 sparc
            0 0.25 0.25 90 210 sparc
            0 -0.25 goto
            closepath nstroke
        grestore
    }
    % this differs from current in that it acts on and pops the 
    % top of the stack rather than querying the current state
    /check {
        gsave
            90 rotate
            sigil_parts /current get exec
        grestore
    }
>> def
/sigil_current { /subsigil arg
    sigil_parts subsigil get exec
    sigil_parts /current get exec
} def
/sigil_set { /subsigil arg
    gsave
        0 4 recip translate
        sigil_parts subsigil get exec
    grestore
    sigil_parts /set get exec
} def
/sigil_bank <<
    /RETURN {
        2 {
            0.5 0 goto
            0 0.375 goto
        } circrepeat
        closepath nstroke
        0.75 -0.25 goto 0.75 0.25 goto nstroke
    }
    /COMPLETE {
        0 -0.25 goto 0 0.25 goto 0.5 0 goto closepath nstroke
    }
    /abs {
        -0.5 0.5 goto
        -0.5 -0.5 goto
        0 0.5 goto
        0.5 -0.5 goto
        0.5 0.5 goto
        nstroke
        -0.25 0 goto 0.25 0 goto nstroke
    }
    /add {
        -0.5 -0.5 goto 0 0.5 goto 0.5 -0.5 goto nstroke
        -0.25 0 goto 0.25 0 goto nstroke
        0 -0.25 goto 0 0.25 goto nstroke
    }
    /and {
        -0.25 -0.5 goto
        0 0.25 0.125 -30 90 sparc
        0 0.25 0.125 90 210 sparc
        0.25 -0.5 goto
        nstroke
        0 0 0.375 -120 -45 sparc
        nstroke
    }
    /arc {
        0 0 0.5 -45 90 sparc
        0 0 0.5 90 215 sparc
        gsave currentpoint newpath ndot grestore
        nstroke
        -0.5 0 goto 0.5 0 goto nstroke
    }
    /arcn {
        0 0 0.5 215 90 sparcn
        0 0 0.5 90 -45 sparcn
        gsave currentpoint newpath ndot grestore
        nstroke
        -0.5 0 goto
        0.125 dup goto
        -0.125 dup goto
        0.5 0 goto nstroke
    }
    /array {
        0 0 0.5 spcircle nstroke
        0 0 0.25 spcircle nstroke
        {
            -30 cos half -30 sin half goto 0.5 -0.5 goto nstroke
        } hmirror
    }
    /atan {
        gsave
            2 recip softscale
            1 -1 goto
            0 0 1 0 180 arc
            -1 -1 goto
            nstroke
            45 sin dup 0.25 spcircle nstroke
            45 sin dup goto
            0 0 goto
            0 45 sin goto
            closepath nstroke
        grestore
    }
    /begin {
        -0.25 0.5 0.5 0 -90 arcn
        -0.25 -0.5 0.5 90 0 arcn
        nstroke
        -0.25 0.5 0.375 0 -90 arcn
        -0.25 -0.5 0.375 90 0 arcn
        nstroke
    }
    /closepath {
        0 0 0.5 60 180 sparc
        0 0 0.5 180 -60 sparc
        0 0 goto
        % 0.5 0 0.5 240 180 sparcn
        % 0.5 0 0.5 180 120 sparcn
        closepath
        gsave currentpoint newpath ndot grestore
        nstroke
        % doot
    }
    /copy {
        0 0 0.5 60 180 sparc
        0 0 0.5 180 -60 sparc
        nstroke
        0.25 0 0.5 60 180 sparc
        0.25 0 0.5 180 -60 sparc
        nstroke
    }
    /cos {
        gsave
            2 recip softscale
            0 0 0.25 spcircle nstroke
            0 0 goto
            0 0 1 45 180 sparc
            0 0 1 180 -45 sparc
            nstroke
            0 45 cos goto 45 cos dup goto nstroke
        grestore
    }
    /def {
        0 0 0.5 spcircle nstroke
        3 {
            0 0.5 goto
        } circrepeat closepath nstroke
    }
    /dict {
        3 { 3 sqrt recip 0 goto
        } circrepeat closepath nstroke
        3 { 3 sqrt recip half 0 goto
        } circrepeat closepath nstroke
    }
    /div {
        -0.25 -0.5 goto -0.25 0.5 goto 0 0 0.5 90 -90 arcn closepath nstroke
        -0.5 0 ndot
        0 0 ndot
    }
    /dup {
        gsave
            -0.125 0 translate
            -0.25 0.5 goto
            0 0 0.5 90 -90 arcn
            -0.25 -0.5 goto
            closepath nstroke
            0 0.5 goto 0 -0.5 goto nstroke
        grestore
    }
    /end {
        gsave
            180 rotate
            sigil_bank /begin get exec
        grestore
    }
    /exch {
        0.5 0.5 goto -0.5 0.5 goto -0.5 -0.5 goto 0.5 -0.5 goto nstroke
        -0.5 0 goto 0.5 0 goto nstroke
        {
            -0.25 -0.25 goto 0.25 0.25 goto 0 0.25 goto nstroke
        } vmirror
    }
    /fill {
        gsave
            2 recip softscale
            -0.75 -1 goto -0.75 1 goto 0.75 1 goto nstroke
            -0.75 0 goto 0.75 0 goto nstroke
            /step 0.25 def
            -0.75 step add step 0.75 step sub {
                0 goto 0 1 rgoto nstroke
            } for
        grestore
    }
    /for {
        gsave
            2 recip softscale
            -0.75 -1 goto -0.75 1 goto 0.75 1 goto nstroke
            -0.75 0 goto 0.75 0 goto nstroke
            -0.75 0.25 add 0.25 0.625 {
                -0.25 goto 0 0.5 rgoto nstroke
            } for
        grestore
    }
    /forall {
        gsave
            2 recip softscale
            -0.75 -1 goto -0.75 1 goto 0.75 1 goto nstroke
            -0.75 0 goto 0.75 0 goto nstroke
            0 0 0.5 spcircle nstroke
        grestore
    }
    /gsave {
        gsave
            0.5 softscale
            0.25 0.5 goto
            0 0.5 0.5 0 180 sparc
            0 -0.5 0.5 180 360 sparc
            0.25 -0.5 goto
            nstroke
        grestore
    }
    /grestore {
        gsave
            180 rotate
            sigil_bank /gsave get exec
        grestore
    }
    /idiv {
        sigil_bank /div get exec
        gsave
            -0.25 0 translate
            2 {
                -0.25 -0.25 goto 0.25 -0.25 goto nstroke
            } circrepeat
        grestore
    }
    /if {
        0 -0.5 goto 0 0.5 goto nstroke
        {
            -0.25 0.5 goto 0.25 0.5 goto nstroke
        } vmirror
        0 -0.5 goto 0 -0.25 0.25 -0.25 0.25 0 curveto nstroke
    }
    /ifelse {
        0 -0.5 goto 0 0.5 goto nstroke
        {
            -0.25 0.5 goto 0.25 0.5 goto nstroke
        } vmirror
        {
            0 -0.5 goto 0 -0.25 0.25 -0.25 0.25 0 curveto nstroke
        } hmirror
    }
    /index {
        0 -0.5 goto 0 0.5 goto nstroke
        {
            -0.25 0.5 goto 0.25 0.5 goto nstroke
        } vmirror
        0 0.25 goto -0.25 0.25 goto -0.25 -0.25 goto nstroke
    }
    /length {
        -0.375 0.5 goto
        -0.375 -0.5 goto
        0.375 -0.5 goto
        0 0.25 rgoto
        nstroke
        -0.25 0.125 0.25 {
            -0.5 goto 0 0.25 rgoto nstroke
        } for
    }
    /lineto {
        -0.375 0.5 goto
        -0.375 -0.5 goto
        0.375 -0.5 goto nstroke
        0.375 -0.5 ndot
    }
    /mod {
        -0.5 -0.5 goto
        -0.5 0.5 goto
        0 0 goto
        0.5 0.5 goto
        0.5 -0.5 goto nstroke
        0 0 0.25 135 180 sparc
        0 0 0.25 180 0 sparc
        0 0 0.25 0 45 sparc
        nstroke
    }
    /moveto {
        -0.5 dup goto
        -0.5 0.5 goto
        0 0 goto
        0.5 0.5 goto
        0.5 -0.5 goto nstroke
        0.5 -0.5 ndot
    }
    /mul {
        {
            0.5 -0.5 goto 0.5 0.5 goto -0.25 -0.25 goto nstroke
        } hmirror
    }
    /neg {
        -0.375 -0.5 goto
        -0.375 0.5 goto
        0.375 -0.5 goto
        0.375 0.5 goto
        nstroke
        -0.25 0 goto 0.25 0 goto nstroke
    }
    /not {
        -0.375 -0.5 goto
        -0.375 0.5 goto
        0.375 -0.5 goto
        0.375 0.5 goto
        nstroke
        -0.25 0 goto 0.25 0 goto 0.25 -0.125 goto nstroke
    }
    /or {
        0 0 0.375 spcircle nstroke
        2 {
            0 0.5 goto 0 0.125 goto nstroke
        } circrepeat
    }
    /pop {
        -0.5 -0.5 goto
        -0.5 0.5 goto
        0.25 0.25 0.25 90 -90 sparcn
        -0.5 0 goto
        whitefill nstroke
        3 {
            -0.25 dup goto 0.25 dup goto nstroke
            45 rotate
        } repeat
    }
    /rand {
       gsave
           0 0.25 translate
           sigil_parts /rand get exec 
       grestore
       3 sqrt 4 div neg 0.75 mul -0.5 goto 0 0.5 rgoto nstroke
       0.25 -0.5 goto 0 -0.25 goto nstroke
    }
    /repeat {
        gsave
            3 {
                0.125 0 goto
                0.375 -0.5 goto
                nstroke
                -0.25 0 translate
            } repeat
        grestore
        -0.375 -0.5 goto
        -0.375 0.5 goto
        0.125 0.25 0.25 90 -90 sparcn
        -0.375 0 goto
        whitefill nstroke
    }
    /roll {
        gsave
            0.125 0 translate
            -0.5 -0.5 goto -0.5 0.25 goto nstroke
            0.25 -0.5 goto -0.25 0 goto nstroke
            gsave
                -0.25 0.25 translate
                3 {
                    0 0 0.25 -30 90 sparc
                    0.125 0.125 goto
                    nstroke
                } circrepeat
            grestore
        grestore
    }
    /rotate {
        gsave
            -90 rotate
            -0.5 -0.5 goto
            -0.5 0.5 goto
            0.25 0.25 0.25 90 -90 sparcn
            -0.5 0 goto
            whitefill nstroke
            0 0 goto 0.5 -0.5 goto nstroke
        grestore
    }
    /scale {
        6 recip softscale
        0 1 translate
        0 1 1 0 270 arc
        0 -2 2 90 -180 arcn nstroke
    }
    /sin {
        gsave
            2 recip softscale
            0 0 0.25 spcircle nstroke
            0 0 1 45 135 arc
            0 0 1 -45 -135 arcn
            nstroke
            2 {
                135 cos 135 sin goto
                135 cos 0 goto
                nstroke
            } circrepeat
        grestore
    }
    /sqrt {
        2 {
            -0.5 0.25 goto
            -0.375 0 goto
            -0.25 0.5 goto
            0.5 0.5 goto
            nstroke
        } circrepeat
        2 {
            0.3125 -0.25 goto
        } circrepeat nstroke
    }
    /stroke {
        0 0.25 goto
        0 0.25 0.25 90 -90 arc
        0 -0.25 0.25 90 -90 arcn
        nstroke
        0 -0.5 ndot
    }
    /sub {
        gsave
            -0.125 0 translate
            0 0.25 0.25 0 180 sparc
            0 0.25 0.25 180 -90 sparc
            0 -0.25 0.25 90 0 sparcn
            0 -0.25 0.25 0 180 sparcn
            nstroke
            0.5 -0.25 goto 0 -0.25 goto nstroke
        grestore
    }
    /translate {
        2 recip softscale
        -0.75 0.75 goto
        0.75 0.75 goto
        nstroke
        0 0.75 goto 0 -1 goto nstroke
        0.5 0.5 goto 0.75 0.75 goto 0.5 1 goto nstroke
    }
    /type {
        sigil_parts /check get exec
        gsave
            0.125 0 translate
            0.375 softscale
            0 0 1 spcircle nstroke
        grestore
    }
    /xcheck {
        sigil_parts /check get exec
        gsave
            0.125 0 translate
            0.375 softscale
            0 18 sin neg translate
            5 {
                0 1 goto
            } 2 schlafrepeat closepath nstroke
        grestore
    }
    /xor {
        -0.5 0.5 goto
        0 0 0.5 -45 90 sparc
        0 0 0.5 90 225 sparc
        0.5 0.5 goto
        nstroke
    }
    /currentcolor { /color sigil_current }
    /setcolor { /color sigil_set }
    /currentcmykcolor { /cmykcolor sigil_current }
    /setcmykcolor { /cmykcolor sigil_set }
    /currentgray { /gray sigil_current }
    /setgray { /gray sigil_set }
    /currenthsbcolor { /hsbcolor sigil_current }
    /sethsbcolor { /hsbcolor sigil_set }
    /currentrgbcolor { /rgbcolor sigil_current }
    /setrgbcolor { /rgbcolor sigil_set }
    /currentlinecap { /linecap sigil_current }
    /setlinecap { /linecap sigil_set }
    /currentlinejoin { /linejoin sigil_current }
    /setlinejoin { /linejoin sigil_set }
    /currentlinewidth { /linewidth sigil_current }
    /setlinewidth { /linewidth sigil_set }
    /currentmatrix { /matrix sigil_current }
    /setmatrix { /matrix sigil_set }
    /currentmiterlimit { /miterlimit sigil_current }
    /setmiterlimit { /miterlimit sigil_set }
    /currentpoint { /point sigil_current }
    /rrand { /rand sigil_current }
    /srand { /rand sigil_set }
    /cvi {
        sigil_parts /cv get exec
        gsave
            0 -0.25 translate
            0.25 softscale
            0 -1 goto 0 1 goto nstroke
            {
                -1 1 goto 1 1 goto nstroke
            } vmirror
        grestore
    }
    /cvlit {
        sigil_parts /cv get exec
        gsave
            0 -0.25 translate
            0.25 softscale
            6 {
                1 0 goto
            } circrepeat closepath nstroke
        grestore
    }
    /cvn {
        sigil_parts /cv get exec
        gsave
            3 recip softscale
            0 -1 translate
            3 {
                0 1 goto
            } circrepeat closepath nstroke
        grestore
    }
    /cvr {
        sigil_parts /cv get exec
        gsave
            0 -0.25 translate
            0.25 softscale
            -1 -1 -0.5 1 box nstroke
            -0.5 1 goto 0.5 0.5 0.5 90 -90 arcn -0.5 0 goto nstroke
            0.5 1 goto 0.5 0 goto
            1 -1 goto 
            0.5 -1 goto 
            0 0 goto 
            nstroke
        grestore
    }
    /cvrs {
        sigil_parts /cv get exec
        gsave
            0 -0.25 translate
            0.25 softscale
            1 0 1 -90 90 sparc
            -1 0 1 90 -90 sparc
            closepath nstroke
            4 {
                -0.5 0.25 goto 0.5 0.25 goto nstroke
            } circrepeat
        grestore
    }
    /cvs {
        sigil_parts /cv get exec
        gsave
            0 -0.25 translate
            0.25 softscale
            1 0 1 -90 90 sparc
            -1 0 1 90 -90 sparc
            closepath nstroke
            -1 0.5 1 {
                -0.5 goto 0 1 rgoto nstroke
            } for
        grestore
    }
    /cvx {
        sigil_parts /cv get exec
        gsave
            0 -0.25 translate
            0.25 softscale
            5 {
                0 1 goto
            } 2 schlafrepeat closepath nstroke
        grestore
    }
>> def

